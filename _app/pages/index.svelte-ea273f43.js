import{S as Ie,i as Ne,s as Me,k as ie,f as V,J as P,K,a as I,d as m,b as a,L as he,M as ce,t as x,g as ee,H as f,N as re,p as J,e as O,v as ye,j as H,c as T,w as Oe,l as L,x as Te,n as oe,A as De,m as We,o as Be,h as me,O as Se,P as Je,Q as Qe,R as je,T as qe,U as Ye,u as Ze}from"../chunks/vendor-3e6eba71.js";class Ge{constructor(o,r=2){if(this.levels=0,this.addEntrant=e=>{this.entrants.push({data:e,id:this.entrants.length}),this.rebuildTournament()},this.getEntrantsData=()=>this.entrants.map(e=>e.data),this.makeEntrants=e=>this.entrants=e.map((n,l)=>({data:n,id:l})),this.removeEntrant=e=>{this.entrants.splice(e,1);for(let n=e;n<this.entrants.length;++n)this.entrants[n].id=n;this.rebuildTournament()},this.rebuildTournament=()=>{this.nodes=this.entrants.map((l,h)=>({childrenIds:null,entrantId:l.id,id:h,isOriginalEntrant:!0,level:0,parentId:null,row:h}));let e=[...this.nodes],n=0;for(;e.length>1;){const l=e.length-Xe(e.length,this.base),h=l>0,b=h?l:e.length/this.base;let N=0;const D=[];for(let M=0;M<b;++M){const s={childrenIds:{},entrantId:null,id:this.nodes.length,isOriginalEntrant:!1,level:n+1,parentId:null,row:M};for(let c=0;c<this.base;++c){const E=e.shift();E.level=n,E.row=N,N++,s.childrenIds[E.id]=!0,this.nodes[E.id].parentId=s.id}this.nodes.push(s),h?D.push(s):e.push(s)}e=D.concat(e),n++}this.levels=n+1,this.nodeMap={},this.nodes.forEach(l=>{this.nodeMap[this.getNodeMapKeyFromNode(l)]=l.id})},this.getNodeIdFromPosition=(e,n)=>this.nodeMap[this.makeNodeMapKey(e,n)],this.getNodeMapKeyFromNode=e=>this.makeNodeMapKey(e.level,e.row),this.makeNodeMapKey=(e,n)=>`${e}-${n}`,this.canSelectNodeWinner=e=>{const n=this.nodes[e.parentId];return n===void 0?new Error("The selected node does not have a parent"):e.entrantId===null?new Error("The selected node does not have an entrant"):Object.keys(n.childrenIds).some(l=>{var h;return typeof((h=this.nodes[parseInt(l)])==null?void 0:h.entrantId)!="number"})?new Error("The selected node's parent must have children with entrants"):!0},this.selectNodeWinner=e=>{const n=this.nodes[e],l=this.nodes[n.parentId];Re(this.canSelectNodeWinner(n)),l.entrantId=n.entrantId},this.canDeselectNodeWinner=e=>{const n=this.nodes[e.parentId];return typeof(n==null?void 0:n.entrantId)=="number"?new Error("You must first deselect the node winner for the parent"):e.entrantId===null?new Error("The selected node does not have an entrant"):e.isOriginalEntrant?new Error("The selected node is an original entrant and cannot be deselected"):!0},this.deselectNodeWinner=e=>{const n=this.nodes[e];this.nodes[n.parentId],Re(this.canDeselectNodeWinner(n)),n.entrantId=null},o.length===0)throw new Error("No entrants data");if(r<2)throw new Error("Log Base must be 2 or greater");this.base=r,this.makeEntrants(o),this.rebuildTournament()}}function Re(t){if(t!==!0)throw t}function Xe(t,o){const r=Math.floor(Math.log(t)/Math.log(o));return Math.pow(o,r)}function xe(t,o){const r=Math.ceil(Math.log(t)/Math.log(o));return Math.pow(o,r)}const Ae="entrants";function $e(t){localStorage.setItem(Ae,JSON.stringify(t))}function et(){try{return JSON.parse(localStorage.getItem(Ae))}catch(t){console.error(t)}}function Fe(t,o,r){const e=t.slice();return e[23]=o[r],e}function Pe(t,o,r){const e=t.slice();return e[23]=o[r],e}function Ke(t,o,r){const e=t.slice();return e[28]=o[r],e}function He(t){let o,r=Object.keys(t[23].node.childrenIds).map(t[16]),e=[];for(let n=0;n<r.length;n+=1)e[n]=Le(Ke(t,r,n));return{c(){for(let n=0;n<e.length;n+=1)e[n].c();o=ie()},l(n){for(let l=0;l<e.length;l+=1)e[l].l(n);o=ie()},m(n,l){for(let h=0;h<e.length;h+=1)e[h].m(n,l);V(n,o,l)},p(n,l){if(l&194){r=Object.keys(n[23].node.childrenIds).map(n[16]);let h;for(h=0;h<r.length;h+=1){const b=Ke(n,r,h);e[h]?e[h].p(b,l):(e[h]=Le(b),e[h].c(),e[h].m(o.parentNode,o))}for(;h<e.length;h+=1)e[h].d(1);e.length=r.length}},d(n){ce(e,n),n&&m(o)}}}function Le(t){let o,r,e;return{c(){o=P("path"),this.h()},l(n){o=K(n,"path",{class:!0,d:!0,stroke:!0,"stroke-width":!0}),I(o).forEach(m),this.h()},h(){a(o,"class",r=""+(he("link"+(t[28].winner?" winner-link":"")+(t[28].loser?" loser-link":""))+" svelte-7vftg3")),a(o,"d",e=`M${t[23].left},${t[23].top+t[6]} ${t[28].left+t[1].w},${t[28].top+t[6]}Z`),a(o,"stroke","#000"),a(o,"stroke-width","2")},m(n,l){V(n,o,l)},p(n,l){l&128&&r!==(r=""+(he("link"+(n[28].winner?" winner-link":"")+(n[28].loser?" loser-link":""))+" svelte-7vftg3"))&&a(o,"class",r),l&194&&e!==(e=`M${n[23].left},${n[23].top+n[6]} ${n[28].left+n[1].w},${n[28].top+n[6]}Z`)&&a(o,"d",e)},d(n){n&&m(o)}}}function Ue(t){let o,r=t[23].node.childrenIds&&He(t);return{c(){r&&r.c(),o=ie()},l(e){r&&r.l(e),o=ie()},m(e,n){r&&r.m(e,n),V(e,o,n)},p(e,n){e[23].node.childrenIds?r?r.p(e,n):(r=He(e),r.c(),r.m(o.parentNode,o)):r&&(r.d(1),r=null)},d(e){r&&r.d(e),e&&m(o)}}}function Ve(t){let o,r,e,n,l,h,b,N,D;n=new qe({props:{icon:Ye}});function M(){return t[17](t[23])}return{c(){o=P("foreignObject"),r=O("div"),e=O("button"),ye(n.$$.fragment),l=H(),this.h()},l(s){o=K(s,"foreignObject",{x:!0,y:!0,height:!0,width:!0});var c=I(o);r=T(c,"DIV",{class:!0});var E=I(r);e=T(E,"BUTTON",{class:!0});var S=I(e);Oe(n.$$.fragment,S),S.forEach(m),l=L(E),E.forEach(m),c.forEach(m),this.h()},h(){a(e,"class","tournament-icon svelte-7vftg3"),a(r,"class","tournament-icon-container svelte-7vftg3"),a(o,"x",-30),a(o,"y",h=t[6]-15),a(o,"height","30"),a(o,"width","30")},m(s,c){V(s,o,c),f(o,r),f(r,e),Te(n,e,null),f(r,l),b=!0,N||(D=re(e,"click",M),N=!0)},p(s,c){t=s,(!b||c&64&&h!==(h=t[6]-15))&&a(o,"y",h)},i(s){b||(J(n.$$.fragment,s),b=!0)},o(s){oe(n.$$.fragment,s),b=!1},d(s){s&&m(o),De(n),N=!1,D()}}}function ze(t){var z;let o,r,e,n,l,h,b,N,D,M,s,c=(((z=t[0].entrants[t[23].node.entrantId])==null?void 0:z.data)||"")+"",E,S,$,v,y,R,_=t[23].node.isOriginalEntrant&&Ve(t);function Q(){return t[18](t[23])}function q(){return t[19](t[23])}function Y(){return t[20](t[23])}return{c(){o=P("g"),_&&_.c(),e=P("g"),n=P("g"),l=P("rect"),s=P("text"),E=x(c),this.h()},l(p){o=K(p,"g",{transform:!0});var g=I(o);_&&_.l(g),g.forEach(m),e=K(p,"g",{class:!0,transform:!0});var d=I(e);n=K(d,"g",{transform:!0});var A=I(n);l=K(A,"rect",{fill:!0,height:!0,stroke:!0,"stroke-width":!0,width:!0,x:!0,y:!0,class:!0}),I(l).forEach(m),A.forEach(m),s=K(d,"text",{dy:!0,"text-anchor":!0,x:!0,y:!0});var j=I(s);E=ee(j,c),j.forEach(m),d.forEach(m),this.h()},h(){a(o,"transform",r=`translate(${t[23].left},${t[23].top})`),a(l,"fill","#fff"),a(l,"height",h=t[1].h),a(l,"stroke","#000"),a(l,"stroke-width","1"),a(l,"width",b=t[1].w),a(l,"x",N=-t[5]),a(l,"y",D=-t[6]),a(l,"class","svelte-7vftg3"),a(n,"transform",M=`translate(${t[5]},${t[6]})`),a(s,"dy","0.35em"),a(s,"text-anchor","middle"),a(s,"x",t[5]),a(s,"y",t[6]),a(e,"class",S=""+(he("node"+(t[23].canSelectNodeWinner?" can-select-winner":"")+(t[23].loser?" loser-node":"")+(typeof t[23].node.entrantId=="number"?" has-entrant":" no-entrant"))+" svelte-7vftg3")),a(e,"transform",$=`translate(${t[23].left},${t[23].top})`)},m(p,g){V(p,o,g),_&&_.m(o,null),V(p,e,g),f(e,n),f(n,l),f(e,s),f(s,E),v=!0,y||(R=[re(l,"click",Q),re(s,"click",q),re(e,"click",Y)],y=!0)},p(p,g){var d;t=p,t[23].node.isOriginalEntrant?_?(_.p(t,g),g&128&&J(_,1)):(_=Ve(t),_.c(),J(_,1),_.m(o,null)):_&&(We(),oe(_,1,1,()=>{_=null}),Be()),(!v||g&128&&r!==(r=`translate(${t[23].left},${t[23].top})`))&&a(o,"transform",r),(!v||g&2&&h!==(h=t[1].h))&&a(l,"height",h),(!v||g&2&&b!==(b=t[1].w))&&a(l,"width",b),(!v||g&32&&N!==(N=-t[5]))&&a(l,"x",N),(!v||g&64&&D!==(D=-t[6]))&&a(l,"y",D),(!v||g&96&&M!==(M=`translate(${t[5]},${t[6]})`))&&a(n,"transform",M),(!v||g&129)&&c!==(c=(((d=t[0].entrants[t[23].node.entrantId])==null?void 0:d.data)||"")+"")&&me(E,c),(!v||g&32)&&a(s,"x",t[5]),(!v||g&64)&&a(s,"y",t[6]),(!v||g&128&&S!==(S=""+(he("node"+(t[23].canSelectNodeWinner?" can-select-winner":"")+(t[23].loser?" loser-node":"")+(typeof t[23].node.entrantId=="number"?" has-entrant":" no-entrant"))+" svelte-7vftg3")))&&a(e,"class",S),(!v||g&128&&$!==($=`translate(${t[23].left},${t[23].top})`))&&a(e,"transform",$)},i(p){v||(J(_),v=!0)},o(p){oe(_),v=!1},d(p){p&&m(o),_&&_.d(),p&&m(e),y=!1,Se(R)}}}function tt(t){let o,r,e,n,l,h,b,N,D,M,s,c,E,S,$,v,y,R,_,Q,q,Y,z,p,g,d,A,j,le,se,W,te,Z,de,U,ue,_e;document.title=o=""+(t[4]+" Food Battle "+t[4]);let ne=t[7],B=[];for(let u=0;u<ne.length;u+=1)B[u]=Ue(Pe(t,ne,u));let G=t[7],w=[];for(let u=0;u<G.length;u+=1)w[u]=ze(Fe(t,G,u));const Ce=u=>oe(w[u],1,1,()=>{w[u]=null});return{c(){r=H(),e=O("div"),n=O("div"),l=O("h1"),h=x(t[4]),b=x(" Food Battle "),N=x(t[4]),D=H(),M=O("p"),s=x("Not sure what to eat? Make your decision, one match at a time!"),c=H(),E=O("br"),S=O("br"),$=H(),v=O("div"),y=P("svg"),R=P("g");for(let u=0;u<B.length;u+=1)B[u].c();_=P("g");for(let u=0;u<w.length;u+=1)w[u].c();Q=H(),q=O("br"),Y=O("br"),z=H(),p=O("form"),g=O("label"),d=O("b"),A=x("Add Another Option"),j=H(),le=O("br"),se=H(),W=O("input"),te=H(),Z=O("button"),de=x("Add"),this.h()},l(u){Je('[data-svelte="svelte-12bepw2"]',document.head).forEach(m),r=L(u),e=T(u,"DIV",{class:!0});var i=I(e);n=T(i,"DIV",{});var F=I(n);l=T(F,"H1",{});var ae=I(l);h=ee(ae,t[4]),b=ee(ae," Food Battle "),N=ee(ae,t[4]),ae.forEach(m),D=L(F),M=T(F,"P",{});var ge=I(M);s=ee(ge,"Not sure what to eat? Make your decision, one match at a time!"),ge.forEach(m),F.forEach(m),c=L(i),E=T(i,"BR",{}),S=T(i,"BR",{}),$=L(i),v=T(i,"DIV",{class:!0});var pe=I(v);y=K(pe,"svg",{height:!0,width:!0});var fe=I(y);R=K(fe,"g",{});var ve=I(R);for(let X=0;X<B.length;X+=1)B[X].l(ve);ve.forEach(m),_=K(fe,"g",{});var we=I(_);for(let X=0;X<w.length;X+=1)w[X].l(we);we.forEach(m),fe.forEach(m),pe.forEach(m),Q=L(i),q=T(i,"BR",{}),Y=T(i,"BR",{}),z=L(i),p=T(i,"FORM",{});var C=I(p);g=T(C,"LABEL",{for:!0});var be=I(g);d=T(be,"B",{});var Ee=I(d);A=ee(Ee,"Add Another Option"),Ee.forEach(m),be.forEach(m),j=L(C),le=T(C,"BR",{}),se=L(C),W=T(C,"INPUT",{id:!0,placeholder:!0,type:!0}),te=L(C),Z=T(C,"BUTTON",{type:!0,style:!0});var ke=I(Z);de=ee(ke,"Add"),ke.forEach(m),C.forEach(m),i.forEach(m),this.h()},h(){a(y,"height",t[2]),a(y,"width",t[8]),a(v,"class","svg-container svelte-7vftg3"),a(g,"for","add-option"),a(W,"id","add-option"),a(W,"placeholder","Ex: \u{1F355} Pizza"),a(W,"type","text"),a(Z,"type","submit"),Qe(Z,"border","1px solid #777"),a(e,"class","tournament svelte-7vftg3")},m(u,k){V(u,r,k),V(u,e,k),f(e,n),f(n,l),f(l,h),f(l,b),f(l,N),f(n,D),f(n,M),f(M,s),f(e,c),f(e,E),f(e,S),f(e,$),f(e,v),f(v,y),f(y,R);for(let i=0;i<B.length;i+=1)B[i].m(R,null);f(y,_);for(let i=0;i<w.length;i+=1)w[i].m(_,null);f(e,Q),f(e,q),f(e,Y),f(e,z),f(e,p),f(p,g),f(g,d),f(d,A),f(p,j),f(p,le),f(p,se),f(p,W),je(W,t[3]),f(p,te),f(p,Z),f(Z,de),U=!0,ue||(_e=[re(W,"input",t[21]),re(p,"submit",t[11])],ue=!0)},p(u,[k]){if((!U||k&16)&&o!==(o=""+(u[4]+" Food Battle "+u[4]))&&(document.title=o),(!U||k&16)&&me(h,u[4]),(!U||k&16)&&me(N,u[4]),k&194){ne=u[7];let i;for(i=0;i<ne.length;i+=1){const F=Pe(u,ne,i);B[i]?B[i].p(F,k):(B[i]=Ue(F),B[i].c(),B[i].m(R,null))}for(;i<B.length;i+=1)B[i].d(1);B.length=ne.length}if(k&5859){G=u[7];let i;for(i=0;i<G.length;i+=1){const F=Fe(u,G,i);w[i]?(w[i].p(F,k),J(w[i],1)):(w[i]=ze(F),w[i].c(),J(w[i],1),w[i].m(_,null))}for(We(),i=G.length;i<w.length;i+=1)Ce(i);Be()}(!U||k&4)&&a(y,"height",u[2]),(!U||k&256)&&a(y,"width",u[8]),k&8&&W.value!==u[3]&&je(W,u[3])},i(u){if(!U){for(let k=0;k<G.length;k+=1)J(w[k]);U=!0}},o(u){w=w.filter(Boolean);for(let k=0;k<w.length;k+=1)oe(w[k]);U=!1},d(u){u&&m(r),u&&m(e),ce(B,u),ce(w,u),ue=!1,Se(_e)}}}function nt(t,o,r){let e,n,l,h,b,N,D,M,{tournament:s}=o,{nodeDims:c={t:10,b:10,l:30,r:5,h:50,w:100}}=o,E,S="\u{1F355}";const $=["\u{1F355}","\u{1F35D}","\u{1F363}","\u{1F35C}","\u{1F96A}","\u{1F32F}","\u{1F354}","\u{1F961}"];function v(d){var j;const A=(j=s.entrants[d.entrantId])==null?void 0:j.data.split(" ")[0];$.includes(A)&&r(4,S=A)}function y(d){s.canSelectNodeWinner(d)&&(s.selectNodeWinner(d.id),r(0,s))}function R(d){d.preventDefault(),s.addEntrant(E.trim()),$e(s.getEntrantsData()),r(0,s)}function _(d){s.removeEntrant(d.entrantId),$e(s.getEntrantsData()),r(0,s)}const Q=d=>N[d],q=d=>_(d.node),Y=d=>y(d.node),z=d=>y(d.node),p=d=>v(d.node);function g(){E=this.value,r(3,E)}return t.$$set=d=>{"tournament"in d&&r(0,s=d.tournament),"nodeDims"in d&&r(1,c=d.nodeDims)},t.$$.update=()=>{t.$$.dirty&2&&r(14,e=c.l+c.r+c.w),t.$$.dirty&2&&r(13,n=c.t+c.b+c.h),t.$$.dirty&1&&r(15,l=xe(s.entrants.length,s.base)),t.$$.dirty&40960&&r(2,h=l*n),t.$$.dirty&16385&&r(8,b=s.levels*e),t.$$.dirty&24583&&r(7,N=s.nodes.map(d=>{const A=Math.pow(s.base,s.levels-1-d.level),j=h/A,le=d.level*e+c.l,se=d.row*j+c.t+j/2-n/2,W=s.nodes[d.parentId],te=typeof d.entrantId=="number"&&typeof(W==null?void 0:W.entrantId)=="number";return{canDeselectNodeWinner:s.canDeselectNodeWinner(d)===!0,canSelectNodeWinner:s.canSelectNodeWinner(d)===!0,left:le,loser:te&&W.entrantId!==d.entrantId,node:d,top:se,winner:te&&W.entrantId===d.entrantId}})),t.$$.dirty&2&&r(6,D=c.h/2),t.$$.dirty&2&&r(5,M=c.w/2)},[s,c,h,E,S,M,D,N,b,v,y,R,_,n,e,l,Q,q,Y,z,p,g]}class rt extends Ie{constructor(o){super();Ne(this,o,nt,tt,Me,{tournament:0,nodeDims:1})}}function ot(t){for(let o=t.length-1;o>0;o--){const r=Math.floor(Math.random()*(o+1));[t[o],t[r]]=[t[r],t[o]]}return t}function lt(t){let o,r,e;return r=new rt({props:{tournament:t[0]}}),{c(){o=O("main"),ye(r.$$.fragment)},l(n){o=T(n,"MAIN",{});var l=I(o);Oe(r.$$.fragment,l),l.forEach(m)},m(n,l){V(n,o,l),Te(r,o,null),e=!0},p(n,[l]){const h={};l&1&&(h.tournament=n[0]),r.$set(h)},i(n){e||(J(r.$$.fragment,n),e=!0)},o(n){oe(r.$$.fragment,n),e=!1},d(n){n&&m(o),De(r)}}}function st(t,o,r){let e,n=et()||["\u{1F355} Pizza","\u{1F35D} Pasta","\u{1F363} Sushi","\u{1F35C} Viet","\u{1F96A} Sando","\u{1F32F} Mexican","\u{1F354} Burgers","\u{1F961} Chinese"];return Ze(()=>{r(1,n=ot(n))}),t.$$.update=()=>{t.$$.dirty&2&&r(0,e=new Ge(n))},[e,n]}class it extends Ie{constructor(o){super();Ne(this,o,st,lt,Me,{})}}export{it as default};
